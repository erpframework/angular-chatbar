!function(t){"function"==typeof define&&define.amd?define("angular-chatbar/_module",["exports"],t):"undefined"!=typeof exports&&t(exports)}(function(t){"use strict";t["default"]=angular.module("jlo-chatbar",[])}),function(t){"function"==typeof define&&define.amd?define("angular-chatbar",["exports","angular-chatbar/chatbar"],t):"undefined"!=typeof exports&&t(exports,require("angular-chatbar/chatbar"))}(function(t,e){"use strict"}),function(t){"function"==typeof define&&define.amd?define("angular-chatbar/chatbar.directive",["exports","./_module","./utils"],t):"undefined"!=typeof exports&&t(exports,require("./_module"),require("./utils"))}(function(t,e,n){"use strict";var a=e["default"],r=n.initResizer;a.directive("jloChatbar",function(){return{restrict:"AE",transclude:!0,scope:!0,controller:["$scope","$element","$attrs","$transclude","jloChatbar",function(t,e,n,a,r){var o,i=n.jloChatbar||n.chatData;if(!i)throw new Error("Missing chat-data attribute");e.addClass("jlo-chatbar"),o=i.match(/^\s*(.+?)(?:\s+controlled\s+by\s+(.+))?\s*$/),this.chatVarName=o[1],this.ctrlVarName=o[2],this.$transclude=a,this.$scope=t,this.chatList=r.list,this.open=function(t,e){return t.open=!0,e&&r.focusChat(t.data)},this.minimize=function(t){return t.open=!1},this.remove=function(t){return r.removeChat(t.data)},this.focus=function(t){return r.focusChat(t.data)}}],controllerAs:"chatBarCtrl",template:['<jlo-chatbar-chat-internal ng-repeat="chat in chatBarCtrl.chatList track by chat.id" tabindex="-1">',"</jlo-chatbar-chat-internal>"].join("")}}),a.directive("jloChatbarResizer",function(){return{require:"^^jloChatbarChatInternal",restrict:"AE",transclude:"element",link:function(t,e,n,a){var o;o=angular.element('<div class="jlo-chatbar__resizer"></div>'),e.after(o),e.remove(),r(o,a.element)}}}),a.directive("jloChatbarFocus",["$q","$window",function(t,e){return{require:"^^?jloChatbarChatInternal",restrict:"AE",link:function(t,n,a,r){r&&t.$on("jlo.chatbar.focus",function(t,o){o===r.chat.data&&setTimeout(function(){n[0].focus(),e.scrollTo(0,0),r.element[0].scrollTop=0},a.jloChatbarFocus&&parseInt(a.jloChatbarFocus,10)||1)})}}}]),a.directive("jloChatbarScroll",["$window",function(t){return{require:"^^?jloChatbarChatInternal",restrict:"AE",link:function(e,n,a,r){function o(){c&&(n[0].scrollTop=n[0].scrollHeight,setTimeout(function(){n[0].scrollTop=n[0].scrollHeight},1))}function i(){s&&clearTimeout(s),s=setTimeout(function(){o(),s=void 0},100)}var c,u,l,s,f=a.jloChatbarScroll||"";u=f.match(/^\s*(?:autoscroll\s+on\s+(.+))?\s*$/),l=u[1],n.on("scroll",function(){c=this.scrollTop+this.offsetHeight>=this.scrollHeight}),r&&(r.element.on("jlo-chat-resize",o),e.$on("$destroy",function(){return r.element.off("jlo-chat-resize",o)})),angular.element(t).on("resize",i),e.$on("$destroy",function(){return angular.element(t).off("resize",i)}),c=!0,l?e.$watchCollection(function(){return[].concat(e.$eval(l))},o):setTimeout(o,1)}}}])}),function(t){"function"==typeof define&&define.amd?define("angular-chatbar/chatbar.internal.directive",["exports","./_module"],t):"undefined"!=typeof exports&&t(exports,require("./_module"))}(function(t,e){"use strict";var n=e["default"];n.directive("jloChatbarChatInternal",["$animate","$timeout",function(t,e){return{require:["jloChatbarChatInternal","^^jloChatbar"],restrict:"AE",controller:function(){},link:function(n,a,r,o){var i=o[0],c=o[1];if(i.element=a,c.$transclude){var u=n.$new(),l={remove:function(){return c.remove(i.chat)},minimize:function(){return c.minimize(i.chat)},open:function(t){return c.open(i.chat,t)},focus:function(){return c.focus(i.chat)}};i.chat=n.chat,c.chatVarName&&(u[c.chatVarName]=i.chat.data),c.ctrlVarName&&(u[c.ctrlVarName]=l),a.empty().addClass("jlo-chatbar__chat"),n.$watch("chat",function(t){i.chat=t,c.chatVarName&&(u[c.chatVarName]=i.chat.data)}),n.$watch("chat.open",function(n,r){function o(){a.toggleClass("jlo-chatbar__chat--closed",!n),t[n?"addClass":"removeClass"](a,"jlo-chatbar__chat--open").then(function(){return u.$closed=!n,u.$open=!!n})}u.$closed=!1,u.$open=!1,"undefined"!=typeof r&&n!==r?e(o,1):o()}),c.$transclude(u,function(e){return t.enter(e,a)})}}}}])}),function(t){"function"==typeof define&&define.amd?define("angular-chatbar/chatbar",["exports","./chatbar.internal.directive","./chatbar.directive","./chatbar.service"],t):"undefined"!=typeof exports&&t(exports,require("./chatbar.internal.directive"),require("./chatbar.directive"),require("./chatbar.service"))}(function(t,e,n,a){"use strict"}),function(t){"function"==typeof define&&define.amd?define("angular-chatbar/chatbar.service",["exports","./_module"],t):"undefined"!=typeof exports&&t(exports,require("./_module"))}(function(t,e){"use strict";var n=e["default"];n.provider("jloChatbar",function(){var t;this.chatId=function(e){return angular.isFunction(e)?void(t=e):void(t=function(t){return t[e]})},this.chatId("id"),this.$get=["$rootScope","$timeout",function(e,n){function a(e){var n=t(e);return r.list.reduce(function(t,e,a){return t>=0?t:e.id===n?a:t},-1)}var r={list:[]};return r.addChat=function(o,i,c){var u,l=a(o);-1!==l&&(u=r.list.splice(l,1)[0]),i="boolean"==typeof i?i:u&&u.open||!1,r.list.unshift(Object.defineProperties({data:o,open:i},{id:{get:function(){return t(this.data)},configurable:!0,enumerable:!0}})),i&&c&&n(function(){return e.$broadcast("jlo.chatbar.focus",o)})},r.focusChat=function(t){var o=a(t);-1!==o&&n(function(){return e.$broadcast("jlo.chatbar.focus",r.list[o].data)})},r.removeChat=function(t){var e=a(t);-1!==e&&r.list.splice(e,1)},r}]})}),function(t){"function"==typeof define&&define.amd?define("angular-chatbar/utils",["exports"],t):"undefined"!=typeof exports&&t(exports)}(function(t){"use strict";function e(t,e){function n(t){e.css("height",i+o-t.clientY+"px"),e.triggerHandler("jlo-chat-resize")}function a(){angular.element(document.body).removeClass("jlo-chatbar-noselect"),angular.element(document).off("mousemove",n).off("mouseup",a)}function r(t){e.data("jlo-chatbar-chat-resized",!0),o=t.clientY,i=parseInt(document.defaultView.getComputedStyle(e[0]).height,10),angular.element(document.body).addClass("jlo-chatbar-noselect"),angular.element(document).on("mousemove",n).on("mouseup",a)}var o,i;t.on("mousedown",r)}t.initResizer=e});