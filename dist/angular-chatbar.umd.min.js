!function(e){"function"==typeof define&&define.amd?define("angular-chatbar/_module",["exports"],e):"undefined"!=typeof exports&&e(exports)}(function(e){"use strict";e["default"]=angular.module("jlo-chatbar",[])}),function(e){"function"==typeof define&&define.amd?define("angular-chatbar",["exports","angular-chatbar/chatbar"],e):"undefined"!=typeof exports&&e(exports,require("angular-chatbar/chatbar"))}(function(){"use strict"}),function(e){"function"==typeof define&&define.amd?define("angular-chatbar/chatbar.directive",["exports","./_module","./chatbar.service","./utils"],e):"undefined"!=typeof exports&&e(exports,require("./_module"),require("./chatbar.service"),require("./utils"))}(function(e,t,n,a){"use strict";var i=t["default"],r=n.serviceData,o=a.applyHeight,c=a.initResizer;i.directive("jloChatbar",function(){return{restrict:"AE",transclude:!0,scope:!0,controller:["$scope","$element","$attrs","$window","jloChatbar",function(e,t,n,a,i){var c=this;t.addClass("jlo-chatbar"),this.$scope=e,this.chatList=i.list,this.chatVarName=n.chat,this.ctrlVarName=n.ctrl,this.open=function(e,t){e.opened=!0,t&&i.focusChat(e.data)},this.minimize=function(e){e.opened=!1},this.remove=function(e){i.removeChat(e.data)},this.height={},(r.maxHeight||r.height)&&!function(){var n=function(){var e=a.innerHeight;c.height={maxHeight:r.maxHeight&&r.maxHeight(e),height:r.height&&r.height(e)},o(t.find("jlo-chatbar-chat-internal"),c.height)};n(),angular.element(a).on("resize",n),e.$on("$destroy",function(){angular.element(a).off("resize",n)})}()}],controllerAs:"chatBarCtrl",template:['<div style="display:none;" ng-transclude></div>','<jlo-chatbar-chat-internal ng-repeat="chat in chatBarCtrl.chatList track by chat.id">',"</jlo-chatbar-chat-internal>"].join("")}}),i.directive("jloChatbarMinimized",function(){return{require:"^^jloChatbar",restrict:"E",priority:700,terminal:!0,transclude:"element",link:function(e,t,n,a,i){a.minimizedTransclude=i}}}),i.directive("jloChatbarOpen",function(){return{require:"^^jloChatbar",restrict:"E",priority:700,terminal:!0,transclude:"element",link:function(e,t,n,a,i){a.openTransclude=i}}}),i.directive("jloChatbarResizer",function(){return{require:"^^jloChatbarChatInternal",restrict:"AE",transclude:"element",link:function(e,t){var n,a;n=t;do n=n.parent();while(n.length&&"jlo-chatbar-chat-internal"!==n[0].tagName.toLowerCase());if(!n.length)throw new Error("jlo-chatbar-resizer must be inside jlo-chatbar-open or jlo-chatbar-minimized");a=angular.element('<div class="jlo-chatbar__resizer"></div>'),t.after(a),t.remove(),c(a,n)}}}),i.directive("jloChatbarFocus",["$q","$window",function(e,t){return{require:"^^jloChatbarChatInternal",restrict:"AE",link:function(e,n,a,i){e.$on("jlo.chatbar.focus",function(e,r){r===i.chat.data&&setTimeout(function(){n[0].focus(),t.scrollTo(0,0)},a.jloChatbarFocus&&parseInt(a.jloChatbarFocus,10)||1)})}}}])}),function(e){"function"==typeof define&&define.amd?define("angular-chatbar/chatbar.internal.directive",["exports","./_module","./utils"],e):"undefined"!=typeof exports&&e(exports,require("./_module"),require("./utils"))}(function(e,t,n){"use strict";var a=t["default"],i=n.applyHeight;a.directive("jloChatbarChatInternal",["$animate",function(e){return{require:["jloChatbarChatInternal","^^jloChatbar"],restrict:"AE",controller:function(){},link:function(t,n,a,r){var o=r[0],c=r[1];if(c.minimizedTransclude||c.openTransclude){var u=t.$new(),h={},l={remove:function(){c.remove(o.chat)},minimize:function(){c.minimize(o.chat)},open:function(e){c.open(o.chat,e)}};o.chat=t.chat,c.chatVarName&&(u[c.chatVarName]=o.chat.data),c.ctrlVarName&&(u[c.ctrlVarName]=l),n.empty().addClass("jlo-chatbar__chat"),t.$watch("chat",function(e){o.chat=e,u[c.chatVarName]=o.chat.data}),t.$watch("chat.opened",function(t){setTimeout(function(){h.open&&h.open.toggleClass("jlo-chatbar__open--visible",t)},1),t&&i(n,c.height),e[t?"addClass":"removeClass"](n,"jlo-chatbar__chat--open")}),c.minimizedTransclude&&c.minimizedTransclude(u,function(e){h.minimized=e,n.append(e),e.addClass("jlo-chatbar__minimized")}),c.openTransclude&&c.openTransclude(u,function(e){h.open=e,n.append(e),e.addClass("jlo-chatbar__open")})}}}}])}),function(e){"function"==typeof define&&define.amd?define("angular-chatbar/chatbar",["exports","./chatbar.internal.directive","./chatbar.directive","./chatbar.service"],e):"undefined"!=typeof exports&&e(exports,require("./chatbar.internal.directive"),require("./chatbar.directive"),require("./chatbar.service"))}(function(){"use strict"}),function(e){"function"==typeof define&&define.amd?define("angular-chatbar/chatbar.service",["exports","./_module"],e):"undefined"!=typeof exports&&e(exports,require("./_module"))}(function(e,t){"use strict";function n(e){return function(t){return angular.isFunction(t)?void(i[e]=t):t.match(/%$/)?(t=parseInt(t),void(i[e]=function(e){return e*t/100})):void(i[e]=function(){return t})}}var a=t["default"],i={maxHeight:void 0,height:void 0};a.provider("jloChatbar",function(){var e;this.chatId=function(t){return angular.isFunction(t)?void(e=t):void(e=function(e){return e[t]})},this.chatId("id"),this.maxHeight=n("maxHeight"),this.height=n("height"),this.$get=["$rootScope","$timeout",function(t,n){function a(e){return i.list.reduce(function(t,n,a){return t>=0?t:n.data===e?a:t},-1)}var i={list:[]};return i.addChat=function(r,o,c){var u,h=a(r);-1!==h&&(u=i.list.splice(h,1)[0]),o=u&&u.opened||!!o,i.list.unshift(Object.defineProperties({data:r,opened:o},{id:{get:function(){return e(this.data)},configurable:!0,enumerable:!0}})),o&&c&&n(function(){return t.$broadcast("jlo.chatbar.focus",r)})},i.focusChat=function(e){var r=a(e);-1!==r&&n(function(){return t.$broadcast("jlo.chatbar.focus",i.list[r].data)})},i.removeChat=function(e){var t=a(e);-1!==t&&i.list.splice(t,1)},i}]}),e.serviceData=i}),function(e){"function"==typeof define&&define.amd?define("angular-chatbar/utils",["exports"],e):"undefined"!=typeof exports&&e(exports)}(function(e){"use strict";function t(e,t){e.length&&t&&(!angular.isUndefined(t.maxHeight)&&e.css("max-height",t.maxHeight+"px"),!angular.isUndefined(t.minHeight)&&e.css("min-height",t.minHeight+"px"),angular.forEach(e,function(e){angular.isUndefined(t.height)||angular.element(e).data("jlo-chatbar-chat-resized")||angular.element(e).css("height",t.height+"px")}))}function n(e,t){function n(e){t.css("height",o+r-e.clientY+"px")}function a(){angular.element(document.body).removeClass("jlo-chatbar-noselect"),angular.element(document).off("mousemove",n).off("mouseup",a)}function i(e){t.data("jlo-chatbar-chat-resized",!0),r=e.clientY,o=parseInt(document.defaultView.getComputedStyle(t[0]).height,10),angular.element(document.body).addClass("jlo-chatbar-noselect"),angular.element(document).on("mousemove",n).on("mouseup",a)}var r,o;e.on("mousedown",i)}e.applyHeight=t,e.initResizer=n});