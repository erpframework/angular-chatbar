!function(t){"function"==typeof define&&define.amd?define("angular-chatbar/_module",["exports"],t):"undefined"!=typeof exports&&t(exports)}(function(t){"use strict";t["default"]=angular.module("jlo-chatbar",[])}),function(t){"function"==typeof define&&define.amd?define("angular-chatbar",["exports","angular-chatbar/chatbar"],t):"undefined"!=typeof exports&&t(exports,require("angular-chatbar/chatbar"))}(function(){"use strict"}),function(t){"function"==typeof define&&define.amd?define("angular-chatbar/chatbar.directive",["exports","./_module","./utils"],t):"undefined"!=typeof exports&&t(exports,require("./_module"),require("./utils"))}(function(t,e,n){"use strict";var a=e["default"],r=n.initResizer;a.directive("jloChatbar",function(){return{restrict:"AE",transclude:!0,scope:!0,controller:["$scope","$element","$attrs","$window","$transclude","jloChatbar",function(t,e,n,a,r,o){e.addClass("jlo-chatbar"),this.$transclude=r,this.$scope=t,this.chatList=o.list,this.chatVarName=n.chat,this.ctrlVarName=n.ctrl,this.open=function(t,e){t.opened=!0,e&&o.focusChat(t.data)},this.minimize=function(t){t.opened=!1},this.remove=function(t){o.removeChat(t.data)},this.focus=function(t){o.focusChat(t.data)}}],controllerAs:"chatBarCtrl",template:['<jlo-chatbar-chat-internal ng-repeat="chat in chatBarCtrl.chatList track by chat.id" tabindex="-1">',"</jlo-chatbar-chat-internal>"].join("")}}),a.directive("jloChatbarResizer",function(){return{require:"^^jloChatbarChatInternal",restrict:"AE",transclude:"element",link:function(t,e){var n,a;n=e;do n=n.parent();while(n.length&&n[0]!==document&&"jlo-chatbar-chat-internal"!==n[0].tagName.toLowerCase());if(!n.length||n[0]===document)throw new Error("jlo-chatbar-resizer must be inside jlo-chatbar-chat-internal");a=angular.element('<div class="jlo-chatbar__resizer"></div>'),e.after(a),e.remove(),r(a,n)}}}),a.directive("jloChatbarFocus",["$q","$window",function(t,e){return{require:"^^jloChatbarChatInternal",restrict:"AE",link:function(t,n,a,r){t.$on("jlo.chatbar.focus",function(t,o){o===r.chat.data&&setTimeout(function(){n[0].focus(),e.scrollTo(0,0)},a.jloChatbarFocus&&parseInt(a.jloChatbarFocus,10)||1)})}}}]),a.directive("jloChatbarScroll",["$window",function(t){return{require:"^^?jloChatbarChatInternal",restrict:"AE",link:function(e,n,a,r){function o(){l&&clearTimeout(l),l=setTimeout(function(){i&&(n[0].scrollTop=n[0].scrollHeight),l=void 0},100)}var i,c,u,l,s=a.jloChatbarScroll||"";if(c=s.match(/^\s*(?:autoscroll\s+on\s+(.+))?\s*$/),u=c[1],n.on("scroll",function(){i=this.scrollTop+this.offsetHeight>=this.scrollHeight}),r){var f=n;do f=f.parent();while(f.length&&f[0]!==document&&"jlo-chatbar-chat-internal"!==f[0].tagName.toLowerCase());f.on("jlo-chat-resize",function(){i&&(n[0].scrollTop=n[0].scrollHeight)})}angular.element(t).on("resize",o),e.$on("$destroy",function(){angular.element(t).off("resize",o)}),i=!0,u?e.$watchCollection(function(){return[].concat(e.$eval(u))},function(){i&&(n[0].scrollTop=n[0].scrollHeight)}):setTimeout(function(){n[0].scrollTop=n[0].scrollHeight})}}}])}),function(t){"function"==typeof define&&define.amd?define("angular-chatbar/chatbar.internal.directive",["exports","./_module"],t):"undefined"!=typeof exports&&t(exports,require("./_module"))}(function(t,e){"use strict";var n=e["default"];n.directive("jloChatbarChatInternal",["$animate","$timeout",function(t,e){return{require:["jloChatbarChatInternal","^^jloChatbar"],restrict:"AE",controller:function(){},link:function(n,a,r,o){var i=o[0],c=o[1];if(c.$transclude){var u=n.$new(),l={remove:function(){return c.remove(i.chat)},minimize:function(){return c.minimize(i.chat)},open:function(t){return c.open(i.chat,t)},focus:function(){return c.focus(i.chat)}};i.chat=n.chat,c.chatVarName&&(u[c.chatVarName]=i.chat.data),c.ctrlVarName&&(u[c.ctrlVarName]=l),a.empty().addClass("jlo-chatbar__chat"),n.$watch("chat",function(t){i.chat=t,u[c.chatVarName]=i.chat.data}),n.$watch("chat.opened",function(n){u.$closed=!1,u.$opened=!1,e(function(){a.toggleClass("jlo-chatbar__chat--minimized",!n),t[n?"addClass":"removeClass"](a,"jlo-chatbar__chat--open").then(function(){return u.$apply(function(){return u.$closed=!n,u.$opened=!!n})})},1)}),c.$transclude(u,function(e){return t.enter(e,a)})}}}}])}),function(t){"function"==typeof define&&define.amd?define("angular-chatbar/chatbar",["exports","./chatbar.internal.directive","./chatbar.directive","./chatbar.service"],t):"undefined"!=typeof exports&&t(exports,require("./chatbar.internal.directive"),require("./chatbar.directive"),require("./chatbar.service"))}(function(){"use strict"}),function(t){"function"==typeof define&&define.amd?define("angular-chatbar/chatbar.service",["exports","./_module"],t):"undefined"!=typeof exports&&t(exports,require("./_module"))}(function(t,e){"use strict";var n=e["default"];n.provider("jloChatbar",function(){var t;this.chatId=function(e){return angular.isFunction(e)?void(t=e):void(t=function(t){return t[e]})},this.chatId("id"),this.$get=["$rootScope","$timeout",function(e,n){function a(t){return r.list.reduce(function(e,n,a){return e>=0?e:n.data===t?a:e},-1)}var r={list:[]};return r.addChat=function(o,i,c){var u,l=a(o);-1!==l&&(u=r.list.splice(l,1)[0]),i=u&&u.opened||!!i,r.list.unshift(Object.defineProperties({data:o,opened:i},{id:{get:function(){return t(this.data)},configurable:!0,enumerable:!0}})),i&&c&&n(function(){return e.$broadcast("jlo.chatbar.focus",o)})},r.focusChat=function(t){var o=a(t);-1!==o&&n(function(){return e.$broadcast("jlo.chatbar.focus",r.list[o].data)})},r.removeChat=function(t){var e=a(t);-1!==e&&r.list.splice(e,1)},r}]})}),function(t){"function"==typeof define&&define.amd?define("angular-chatbar/utils",["exports"],t):"undefined"!=typeof exports&&t(exports)}(function(t){"use strict";function e(t,e){function n(t){e.css("height",i+o-t.clientY+"px"),e.triggerHandler("jlo-chat-resize")}function a(){angular.element(document.body).removeClass("jlo-chatbar-noselect"),angular.element(document).off("mousemove",n).off("mouseup",a)}function r(t){e.data("jlo-chatbar-chat-resized",!0),o=t.clientY,i=parseInt(document.defaultView.getComputedStyle(e[0]).height,10),angular.element(document.body).addClass("jlo-chatbar-noselect"),angular.element(document).on("mousemove",n).on("mouseup",a)}var o,i;t.on("mousedown",r)}t.initResizer=e});